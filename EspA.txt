ESP A CODE:

// ===================================================
// ESP32-A  â†’ SENSOR NODE (FIXED FOR ESP32 CORE 3.x)
// LM35 + MAX30102 â†’ ESP-NOW transmit
// ===================================================

#include <WiFi.h>
#include <esp_now.h>
#include <Wire.h>

#define LM35_PIN 34

// ===== Receiver MAC =====
uint8_t receiverMAC[] = <Mac_Address>;// enter ur mac Mac_Address

// ===== Data packet =====
typedef struct {
  float bpm;
  float spo2;
  float temp;
} SensorData;

SensorData data;


// ===== NEW CALLBACK (IMPORTANT FIX) =====
void OnDataSent(const wifi_tx_info_t *info, esp_now_send_status_t status) {
  Serial.println(status == ESP_NOW_SEND_SUCCESS ? "Sent OK" : "Send Fail");
}


void setup() {
  Serial.begin(115200);
  delay(1000);

  WiFi.mode(WIFI_STA);

  if (esp_now_init() != ESP_OK) {
    Serial.println("ESP-NOW init failed");
    return;
  }

  esp_now_register_send_cb(OnDataSent);

  esp_now_peer_info_t peerInfo = {};
  memcpy(peerInfo.peer_addr, receiverMAC, 6);
  peerInfo.channel = 0;
  peerInfo.encrypt = false;

  esp_now_add_peer(&peerInfo);

  Serial.println("Sensor Node Ready ðŸš€");
}


void loop() {

  // LM35 temp
  int raw = analogRead(LM35_PIN);
  data.temp = (raw * 3.3 / 4095.0) * 100.0;

  // Dummy vitals (safe for testing)
  data.bpm  = random(72, 90);
  data.spo2 = random(96, 100);

  esp_now_send(receiverMAC, (uint8_t *)&data, sizeof(data));

  delay(500);
}

